<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Instagram</title>
    <link rel="stylesheet" href="style.css">
    <link rel="shortcut icon"
        href="https://static.vecteezy.com/system/resources/previews/017/743/717/non_2x/instagram-icon-logo-free-png.png"
        type="image/x-icon">
    <script src="https://kit.fontawesome.com/174a9c1444.js" crossorigin="anonymous"></script>
</head>

<body>
    <div id="profileScreen">

        <div class="mainProfileContainer">
            <div class="navbarWrapper">
                <div class="instLogoContainer">
                    <img src="./images/instalogo.png" alt="">
                </div>

                <div class="navlinkWrapper">
                    <div class="navlink" onclick="window.location.href='./index.html'">
                        <span class="nlIcon"><i class="fa-solid fa-house"></i></span>
                        <span class="navlinkName activeLink">Home</span>
                    </div>
                    <div class="navlink" onclick="openNav()">
                        <span class="nlIcon"><i class="fa-solid fa-magnifying-glass"></i> </span>
                        <span class="navlinkName">Search </span>
                    </div>
                    <div class="navlink">
                        <span class="nlIcon"> <i class="fa-regular fa-compass"></i></span>
                        <span class="navlinkName"> Explore </span>
                    </div>
                    <div class="navlink">
                        <span class="nlIcon"><i class="fa-regular fa-circle-play"></i> </span>
                        <span class="navlinkName"> Reels </span>
                    </div>
                    <div class="navlink">
                        <span class="nlIcon"><i class="fa-regular fa-message"></i> </span>
                        <span class="navlinkName"> Messages </span>
                    </div>
                    <div class="navlink">
                        <span class="nlIcon"><i class="fa-regular fa-heart"></i> </span>
                        <span class="navlinkName"> Notifications </span>
                    </div>
                    <div class="navlink">
                        <span class="nlIcon"><i class="fa-regular fa-square-plus"></i> </span>
                        <span class="navlinkName"> create </span>
                    </div>
                    <div class="navlink" onclick="window.location.href='./UserProfile.html'">
                        <span class="nlIcon"> <i class="fa-regular fa-user"></i> </span>
                        <span class="navlinkName" id="switch">Profile </span>
                    </div>

                    <div id="logout" class="navlink"></div>

                    <div class="navlink">
                        <span class="nlIcon"><i class="fa-solid fa-bars"></i></span>
                        <span class="navlinkName"> More </span>
                    </div>

                    <!-- --------------------------------->

                    <div id="mySidenav" class="sidenav">
                        <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>

                        <div class="slidenavContsiner">
                            <div class="leftSlideNav">
                                <div class="smaallinstalogowrap">
                                    <img src="./images/sminstalogo.png" alt="">
                                </div>

                                <div class="navlinkWrapper">
                                    <div class="navlink" onclick="window.location.href='./index.html'">
                                        <span class="nlIcon"><i class="fa-solid fa-house"></i></span>

                                    </div>
                                    <div class="navlink">
                                        <span class="nlIcon"><i class="fa-solid fa-magnifying-glass"></i> </span>
                                    </div>
                                    <div class="navlink">
                                        <span class="nlIcon"> <i class="fa-regular fa-compass"></i></span>
                                    </div>
                                    <div class="navlink">
                                        <span class="nlIcon"><i class="fa-regular fa-circle-play"></i> </span>
                                    </div>
                                    <div class="navlink">
                                        <span class="nlIcon"><i class="fa-regular fa-message"></i> </span>
                                    </div>
                                    <div class="navlink">
                                        <span class="nlIcon"><i class="fa-regular fa-heart"></i> </span>
                                    </div>
                                    <div class="navlink">
                                        <span class="nlIcon"><i class="fa-regular fa-square-plus"></i> </span>
                                    </div>
                                    <div class="navlink" onclick="window.location.href='./UserProfile.html'">
                                        <span class="nlIcon"> <i class="fa-regular fa-user"></i> </span>
                                        <span class="navlinkName" id="switch"></span>
                                    </div>

                                    <div id="logout" class="navlink"></div>

                                    <div class="navlink">
                                        <span class="nlIcon"><i class="fa-solid fa-bars"></i></span>
                                    </div>
                                </div>
                            </div>


                            <div class="rightslideSearch">
                                <div class="searchbarWrapper">
                                    <div class="searchHeader">
                                        <h2 class="searchslTxt">Search</h2>
                                        <input id="searchbar" onkeyup="search_user()" type="search" autocomplete="off"
                                            name="search" placeholder="Search.." class="searchslinputf">
                                    </div>
                                    <div class="searchFooter">
                                        <div class='list' id="show">
                                        </div>
                                    </div>
                                </div>

                            </div>

                        </div>

                    </div>

                </div>

            </div>

            <div class="rightMainProfileContainer">
                <div class="UProfileTopSection" id="finalProfile">
                    <div class="UProfileLeftSection">
                        <div class="UPofileImag" id="profileImage">
                            <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQjYmlp9JDeNMaFZzw9S3G1dVztGqF_2vq9nA&usqp=CAU"
                                alt="">
                        </div>

                    </div>
                    <div class="UProfileRightSection">
                        <div class="TopUProfileOptions">
                            <span class="UInstaID" id="profileSubname">Name </span>
                            <span class="EditProfileOption" onclick="window.location.href='addProfileBio.html'">edit
                                profile </span>
                            <span class="UProfileSettingOption"><i class="fa-solid fa-gear"></i></span>
                        </div>

                        <div class="MiddleProfileOptions">
                            <div class="postTxtCountWrap">
                                <span class="PostCount"> 0</span>
                                <span class="PostTxt">posts</span>
                            </div>
                            <div class="followersTxtCountWrap">
                                <span class="followersCount"  id="followerId" > 0</span>
                                <span class="followersTxt">followers</span>
                            </div>
                            <div class="followingTxtCountWrap">
                                <span class="followingCount" id="followingID"> 0</span>
                                <span class="followingTxt">following</span>
                            </div>

                        </div>

                        <div class="UProfileBioWrapper" id="ProfileBio">
                            <!-- <div class="UserSubName" > M</div> -->
                            <div class="UserBio"> </div>
                        </div>
                    </div>

                </div>

                <div class="UProfileBottomSection">
                    <div class="ProfilePostOptionsWrap">
                        <div class="ProfileOptionConatainer activePOpt">
                            <span class="postOptIcon"><i class="fa-solid fa-table-cells"></i></span>
                            <span class="postOptName">posts </span>
                        </div>
                        <div class="ProfileOptionConatainer">
                            <span class="postOptIcon"><i class="fa-regular fa-bookmark"></i></span>
                            <span class="postOptName">saved </span>
                        </div>
                        <div class="ProfileOptionConatainer">
                            <span class="postOptIcon"><i class="fa-solid fa-clipboard-user"></i></span>
                            <span class="postOptName">tagged </span>
                        </div>
                    </div>

                    <div class="mainProfilePostContainer" id="finalPost">
                        <div class="PflPostImage" id="postImage">
                            <!-- <img src="./images/profilepost2.jpg" alt=""> -->
                            <div class="overlay ">
                                <span class="overlayIcon">
                                    <span class="ovicon"><i class="fa-solid fa-heart"></i>0</span>
                                    <span class="ovicon"><i class="fa-solid fa-comment"></i>0</span>
                                </span>
                            </div>
                        </div>

                    </div>

                </div>

                <!-- footer -->
                <div class="footer">
                    <div class="footerWrapper">
                        <span class="footerLink"> Meta</span>
                        <span class="footerLink"> about</span>
                        <span class="footerLink"> blog </span>
                        <span class="footerLink"> jobs</span>
                        <span class="footerLink"> help</span>
                        <span class="footerLink"> API</span>
                        <span class="footerLink"> privacy</span>
                        <span class="footerLink"> terms</span>
                        <span class="footerLink"> Top Accounts</span>
                        <span class="footerLink"> locations</span>
                        <span class="footerLink"> instagram lite</span>
                        <span class="footerLink"> contact uploading & non-users</span>
                        <span class="footerLink"> meta verified</span>
                    </div>

                    <div class="copyrightFooter">
                        <span class="footerLink">English</span>
                        <span class="footerLink">© 2023 Instagram from Meta</span>
                    </div>
                </div>


            </div>

        </div>

    </div>


    <script>
        window.onload = function () {
            // alert("working")
            var currentUser = JSON.parse(localStorage.getItem("InstaCurrentUser"))
            // console.log(currentUser,"current user");
            if (!!currentUser) {
                // alert(currenUser,"username")
                var logoutDiv = document.getElementById("logout")
                var divfromHtml = document.getElementById("switch");
                // console.log(divfromHtml, "divfromhtml");
                // var h1=document.createElement("h1");
                // h1.innerText="Mayuri"
                // divfromHtml.append(h1)
                var button = '<span class="nlIcon"><i class="fa-solid fa-arrow-right-from-bracket id=logout-icon"></i></span> <span onclick="logout()" class="navlinkName">Logout</span>'
                var name = `<span>${currentUser.userName}</span>`;
                divfromHtml.innerHTML = name;
                logoutDiv.innerHTML = button;

            }
            //  else {
            //     alert("current user absent")
            // }




            // user profile-Bio section

            var currentUser = JSON.parse(localStorage.getItem("InstaCurrentUser"))

            var userData = JSON.parse(localStorage.getItem("InstaUsers"))
            var divToAppendprofileImage = document.getElementById("profileImage")
            var divToAppendprofileSubname = document.getElementById("profileSubname")
            var divToAppendProfileBio = document.getElementById("ProfileBio")
            var divToAppendfinalProfile = document.getElementById("finalProfile")
            var divForFollowing = document.getElementById("followingID")
            if (!!currentUser) {
                var finalProfileBio;
                var followingCount;
                for (var i = 0; i < userData.length; i++) {
                    if (currentUser.userEmail === userData[i].userEmail) {
                        finalProfileBio = userData[i].userbio
                        followingCount = userData[i].following;
                    }
                    console.log(finalProfileBio);
                }
            }
            var forbioimg = ""
            var forbioname = ""
            var forbiobio = ""
            var following=`${followingCount}`
            var finalstrBio = ` 
                    <div class="UProfileLeftSection" >
                        <div class="UPofileImag" id="profileImage">
                            <img src="${finalProfileBio.pimage}"
                                alt="">
                        </div>

                    </div>
                    <div class="UProfileRightSection">
                        <div class="TopUProfileOptions">
                            <span class="UInstaID" id="profileSubname">${finalProfileBio.pSubname} </span>
                            <span class="EditProfileOption" onclick="window.location.href='addProfileBio.html'">edit
                                profile </span>
                            <span class="UProfileSettingOption"><i class="fa-solid fa-gear"></i></span>
                        </div>

                        <div class="MiddleProfileOptions">
                            <div class="postTxtCountWrap">
                                <span class="PostCount"> 1</span>
                                <span class="PostTxt">posts</span>
                            </div>
                            <div class="followersTxtCountWrap">
                                <span class="followersCount" id="followerId" > 1</span>
                                <span class="followersTxt">followers</span>
                            </div>
                            <div class="followingTxtCountWrap">
                                <span class="followingCount"  id="followingID"> ${followingCount}</span>
                                <span class="followingTxt">following</span>
                            </div>

                        </div>

                        <div class="UProfileBioWrapper" id="ProfileBio">
                            <!-- <div class="UserSubName" > M</div> -->
                            <div class="UserBio">${finalProfileBio.bio}</div>
                        </div>
                    </div>

                `


            divToAppendprofileImage.innerHTML = forbioimg;
            divToAppendprofileSubname.innerHTML = forbioname;
            divToAppendProfileBio.innerHTML = forbiobio;
            divToAppendfinalProfile.innerHTML = finalstrBio;
            divForFollowing.innerHTML = following;


            // user profile post section

            var currentUser = JSON.parse(localStorage.getItem("InstaCurrentUser"))
            var userData = JSON.parse(localStorage.getItem("InstaUsers"))
            var userProfilePost = JSON.parse(localStorage.getItem("InstProfilePosts"))
            for (var i = 0; i < userData.length; i++) {
                if (currentUser.userEmail === userData[i].userEmail) {
                    // alert("got")
                    if (userData[i].posts == undefined) {
                        userData[i].posts = userProfilePost[i];
                    }
                    // alert("profile post created.")

                }
            }
            localStorage.setItem("InstaUsers", JSON.stringify(userData))


            var divToAppendPostImage = document.getElementById("postImage")
            var divToAppendfinalPost = document.getElementById("finalPost")
            var products = [];
            for (var i = 0; i < userProfilePost.length; i++) {
                if (currentUser.userEmail == userProfilePost[i].PostUserEmail) {
                    products.push(userProfilePost[i])
                }
            }
            console.log(products, "posts here");

            var finalPostImage = "";
            var finalPost = "";

            for (var i = 0; i < products.length; i++) {
                finalPost += divToAppendPostImage = `
                <div class="PflPostImage" id="postImage">   
                    <img src="${products[i].UserPImg}"> 
                    <div class="overlay ">
                            <span class="overlayIcon">
                                 <span class="ovicon"><i class="fa-solid fa-heart"></i>0</span>
                                 <span class="ovicon"><i class="fa-solid fa-comment"></i>0</span>
                            </span>
                    </div>
                </div>`

            }
            divToAppendPostImage.innerHTML = finalPostImage;
            divToAppendfinalPost.innerHTML = finalPost;

        }

        function logout() {
            alert("Logout successful.")
            localStorage.removeItem("InstaCurrentUser")
            window.location.reload()
            window.location.href = "./login.html"


        }
    </script>

    <script src="./main.js"></script>
</body>

</html>